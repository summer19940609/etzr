<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="utf-8">
    <title>
        <%=title%>
    </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="description" content="Paper - Material Admin Theme">
    <meta name="author" content="KaijuThemes">
    <link rel="shortcut icon" href="<%=staticUrl%>/javascripts/assets/img/logo-icon-dark.png">
    <link type='text/css' href='http://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500' rel='stylesheet'>
    <link type='text/css' href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="<%=staticUrl%>/javascripts/assets/fonts/font-awesome/css/font-awesome.min.css" type="text/css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="<%=staticUrl%>/javascripts/assets/css/styles.css" type="text/css" rel="stylesheet">
    <!-- Core CSS with all styles -->
    <link href="<%=staticUrl%>/javascripts/assets/plugins/codeprettifier/prettify.css" type="text/css" rel="stylesheet">
    <!-- Code Prettifier -->
    <link href="<%=staticUrl%>/javascripts/assets/plugins/dropdown.js/jquery.dropdown.css" type="text/css" rel="stylesheet">
    <!-- iCheck -->
    <link href="<%=staticUrl%>/javascripts/assets/plugins/progress-skylo/skylo.css" type="text/css" rel="stylesheet">
    <!-- Skylo -->
    <!--[if lt IE 10]>
        <script src="<%=staticUrl%>/javascripts/assets/js/media.match.min.js"></script>
        <script src="<%=staticUrl%>/javascripts/assets/js/respond.min.js"></script>
        <script src="<%=staticUrl%>/javascripts/assets/js/placeholder.min.js"></script>
    <![endif]-->
    <!-- The following CSS are included as plugins and can be removed if unused-->
    <link href="<%=staticUrl%>/javascripts/assets/plugins/form-daterangepicker/daterangepicker-bs3.css" type="text/css" rel="stylesheet">
    <!-- DateRangePicker -->
    <link href="<%=staticUrl%>/javascripts/assets/plugins/fullcalendar/fullcalendar.css" type="text/css" rel="stylesheet">
    <!-- FullCalendar -->
    <link href="<%=staticUrl%>/javascripts/assets/plugins/jvectormap/jquery-jvectormap-2.0.2.css" type="text/css" rel="stylesheet">
    <link href="<%=staticUrl%>/javascripts/assets/less/card.less" type="text/css" rel="stylesheet">
    <link href="<%=staticUrl%>/javascripts/assets/plugins/chartist/dist/chartist.min.css" type="text/css" rel="stylesheet">
</head>
<script>
var etzrUrl = "<%=url%>";
var user_id = "<%=user_id%>";
var token = "<%=token%>";
</script>

<body class="animated-content infobar-overlay">
    <div id="wrapper">
        <div id="layout-static">
            <div class="static-sidebar-wrapper sidebar-blue">
                <div class="static-sidebar">
                    <div class="sidebar">
                        <div class="widget" id="widget-profileinfo">
                            <div class="widget-body">
                                <div class="userinfo ">
                                    <div class="avatar pull-left">
                                        <img src="<%=staticUrl%>/javascripts/assets/img/self.png" class="img-responsive img-circle">
                                    </div>
                                    <div class="info">
                                        <span class="username">管理员</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="widget stay-on-collapse" id="widget-sidebar">
                            <nav role="navigation" class="widget-body">
                                <ul class="acc-menu">
                                    <li class="nav-separator"><span>导航</span></li>
                                    <li><a class="withripple" href="/etzr_services/"><span class="icon">
                                    <i class="material-icons">home</i></span><span>扎染日记</span></a></li>
                                    <li><a class="withripple" href="/etzr_services/finework"><span class="icon"><i class="material-icons">code</i></span><span>扎染佳作</span></a></li>
                                    <li><a class="withripple" href="/etzr_services/activity"><span class="icon"><i class="fa fa-bell" aria-hidden="true"></i></span><span>扎染活动</span></a>
                                    </li>
                                    <li><a class="withripple" href="/etzr_services/postcom"><span class="icon"><i class="material-icons">settings</i></span><span>交流沟通</span></a>
                                    </li>
                                    <li><a class="withripple" href="/etzr_services/teacher"><span class="icon"><i class="material-icons">shuffle</i></span><span>教师信息</span></a>
                                    </li>
                                    <li id="exit"><a class="withripple" href="javascript:;"><span class="icon"><i class="fa fa-sign-out" aria-hidden="true"></i></span><span>退出登录</span></a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <div class="static-content-wrapper">
                <div class="static-content">
                    <div class="page-content">
                        <ol class="breadcrumb">
                            <li class=""><a href="/etzr_services/">首页</a></li>
                            <li class="active"><a href="#">扎染日记</a></li>
                        </ol>
                        <div class="page-heading">
                            <h1>扎染日记</h1>
                        </div>
                        <div class="container-fluid">
                            <div data-widget-group="group1">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="panel panel-default">
                                            <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#addDiary">
                                                发布日记
                                            </button>
                                            <div class="panel-heading">
                                                <h2>审核通过日记</h2>
                                                <div class="panel-ctrls" style="display: flex;align-items: center;justify-content: space-around;height: 48px;">
                                                    <span>排序方式：</span>
                                                    <select class="chooseOrderType" style="margin-right: 10px;">
                                                        <option value="create_time">数据库添加时间</option>
                                                        <option value="new_create_time" selected>发布时间</option>
                                                        <option value="thumbsUp_num">点赞数</option>
                                                    </select>
                                                    <select class="chooseOrder">
                                                        <option value="DESC" selected>倒序</option>
                                                        <option value="ASC">正序</option>
                                                    </select>
                                                </div>
                                                <!-- 排序方式选择 -->
                                                <!-- 记录排序规则 -->
                                                <input type="hidden" class="orderType" value="new_create_time">
                                                <!-- 记录排序方式 -->
                                                <input type="hidden" class="order" value="DESC">
                                            </div>
                                            <div class="panel-body no-padding">
                                                <table class="table table-striped table-bordered" cellspacing="0" width="100%">
                                                    <thead>
                                                        <tr>
                                                            <th>用户昵称</th>
                                                            <th>日记内容</th>
                                                            <th style="text-align: center;">天气</th>
                                                            <th style="text-align: center;">点赞数量</th>
                                                            <th>日记图片</th>
                                                            <th style="text-align: center;">操作</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="diaryPass">
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="panel-footer row">
                                                <div class="col-sm-6">
                                                    <div class="dataTables_paginate paging_bootstrap" id="example_paginate">
                                                        <ul class="pagination pull-right m-n" id="pageNumArea">
                                                            <!-- <li class="active"><a href="#">1</a></li>
                                                           <li><a href="#">2</a></li>
                                                           <li><a href="#">3</a></li>
                                                           <li><a href="#">4</a></li>
                                                           <li><a href="#">5</a></li> -->
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h2>审核未通过日记</h2>
                                                <div class="panel-ctrls"></div>
                                            </div>
                                            <div class="panel-body no-padding">
                                                <table class="table table-striped table-bordered" cellspacing="0" width="100%">
                                                    <thead>
                                                        <tr>
                                                            <th>用户昵称</th>
                                                            <th>日记内容</th>
                                                            <th>天气</th>
                                                            <th>日记图片</th>
                                                            <th>操作</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="diaryNotPass">
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="panel-footer row">
                                                <div class="col-sm-6">
                                                    <div class="dataTables_paginate paging_bootstrap" id="example_paginate">
                                                        <ul class="pagination pull-right m-n" id="pageNumArea-checking">
                                                            <!-- <li class="active"><a href="#">1</a></li>
                                                           <li><a href="#">2</a></li>
                                                           <li><a href="#">3</a></li>
                                                           <li><a href="#">4</a></li>
                                                           <li><a href="#">5</a></li> -->
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- .container-fluid -->
                    </div>
                    <!-- #page-content -->
                </div>
                <footer role="contentinfo">
                    <div class="clearfix">
                        <ul class="list-unstyled list-inline pull-left">
                            <li>
                                <h6 style="margin: 0;">&copy; 2017 儿童扎染</h6></li>
                        </ul>
                    </div>
                </footer>
            </div>
        </div>
    </div>
    <div class="modal fade bs-example-modal-sm" id="addDiary" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <h3 style="text-align: center;">添加日记</h3>
                    <div class="form-horizontal">
                        <div class="form-group">
                            <label for="exampleInputEmail1" class="col-sm-3 control-label">天气</label>
                            <div class="col-sm-9">
                                <select id="weather" class="form-control">
                                    <option value="fog">雾</option>
                                    <option value="cloudy">多云</option>
                                    <option value="overcast">阴</option>
                                    <option value="rain">雨</option>
                                    <option value="sleet">雨夹雪</option>
                                    <option value="sunny">晴</option>
                                    <option value="thundershower">雷阵雨</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputPassword1" class="col-sm-3 control-label">身份</label>
                            <div class="col-sm-9">
                                <select id="roleType" class="form-control">
                                    <option value="1">学生</option>
                                    <option value="2">教师</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1" class="col-sm-3 control-label">时间</label>
                            <div class="col-sm-9">
                                <input type="text" class="form-control" id="add_time" placeholder="点击选择时间">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1" class="col-sm-3 control-label">内容</label>
                            <div class="col-sm-9">
                                <textarea id="content" class="form-control" rows="3" placeholder="输入内容"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-3 col-sm-9">
                                <label for="file" class="control-label" style="color: #03a9f4;display: block;width: 100px;height: 30px;background: #e8f5e9;text-align: center;border: 1px solid #37474f;">选择图片</label>
                                <input type="file" id="file" class="form-control" multiple="multiple" style="display: none;">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-3 col-sm-9">
                                <input type="button" class="btn btn-primary" onclick="submit()" value="提交">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Das FAB -->
    <!-- /Switcher -->
    <!-- Load site level scripts -->
    <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script> -->
    <script src="<%=staticUrl%>/javascripts/assets/js/jquery-1.10.2.min.js"></script>
    <!-- Load jQuery -->
    <script src="<%=staticUrl%>/javascripts/assets/js/jqueryui-1.10.3.min.js"></script>
    <!-- Load jQueryUI -->
    <script src="<%=staticUrl%>/javascripts/assets/js/bootstrap.min.js"></script>
    <!-- Load Bootstrap -->
    <script src="<%=staticUrl%>/javascripts/assets/js/enquire.min.js"></script>
    <!-- Load Enquire -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/velocityjs/velocity.min.js"></script>
    <!-- Load Velocity for Animated Content -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/velocityjs/velocity.ui.min.js"></script>
    <script src="<%=staticUrl%>/javascripts/assets/plugins/progress-skylo/skylo.js"></script>
    <!-- Skylo -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/wijets/wijets.js"></script>
    <!-- Wijet -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/sparklines/jquery.sparklines.min.js"></script>
    <!-- Sparkline -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/codeprettifier/prettify.js"></script>
    <!-- Code Prettifier  -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/bootstrap-tabdrop/js/bootstrap-tabdrop.js"></script>
    <!-- Bootstrap Tabdrop -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/nanoScroller/js/jquery.nanoscroller.min.js"></script>
    <!-- nano scroller -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/dropdown.js/jquery.dropdown.js"></script>
    <!-- Fancy Dropdowns -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/bootstrap-material-design/js/material.min.js"></script>
    <!-- Bootstrap Material -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/bootstrap-material-design/js/ripples.min.js"></script>
    <!-- Bootstrap Material -->
    <script src="<%=staticUrl%>/javascripts/assets/js/application.js"></script>
    <script src="<%=staticUrl%>/javascripts/assets/demo/demo.js"></script>
    <script src="<%=staticUrl%>/javascripts/assets/demo/demo-switcher.js"></script>
    <!-- End loading site level scripts -->
    <!-- Load page level scripts-->
    <!-- Charts -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/charts-flot/jquery.flot.min.js"></script>
    <!-- Flot Main File -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/charts-flot/jquery.flot.pie.min.js"></script>
    <!-- Flot Pie Chart Plugin -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/charts-flot/jquery.flot.stack.min.js"></script>
    <!-- Flot Stacked Charts Plugin -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/charts-flot/jquery.flot.resize.min.js"></script>
    <!-- Flot Responsive -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/charts-flot/jquery.flot.tooltip.min.js"></script>
    <!-- Flot Tooltips -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/charts-flot/jquery.flot.spline.js"></script>
    <!-- Flot Curved Lines -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/easypiechart/jquery.easypiechart.min.js"></script>
    <!-- EasyPieChart-->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/curvedLines-master/curvedLines.js"></script>
    <!-- marvinsplines -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/form-daterangepicker/moment.min.js"></script>
    <!-- Moment.js for Date Range Picker -->
    <!-- Date Range Picker -->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/bootstrap-datepicker/bootstrap-datepicker.js"></script>
    <!-- Datepicker -->
    <!-- <script src="<%=staticUrl%>/javascripts/assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script> -->
    <!-- DateTime Picker -->
    <!-- <script src="<%=staticUrl%>/javascripts/assets/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>   -->
    <!-- jVectorMap -->
    <!-- <script src="<%=staticUrl%>/javascripts/assets/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>  -->
    <!--World Map-->
    <script src="<%=staticUrl%>/javascripts/assets/plugins/chartist/dist/chartist.min.js"></script>
    <!-- chartist -->
    <script src="<%=staticUrl%>/javascripts/assets/demo/demo-index.js"></script>
    <!-- 日记 -->
    <script src="<%=staticUrl%>/javascripts/diary.js"></script>
    <script src="<%=staticUrl%>/javascripts/laydate/laydate.js"></script>
    <script>
    //时间选择器laydate
    laydate.render({
        elem: '#add_time',
        type: 'datetime',
        theme: '#5a8ccb'
    });

    function submit() {
        var content = $("#content").val();
        var weather = $("#weather").val();
        var roleType = $("#roleType").val();
        var add_time = $("#add_time").val();
        console.log(add_time);
        console.log(content);
        console.log(roleType);
        var url = etzrUrl + "/diary/add"; // 接收上传文件的后台地址
        var form = new FormData(); // FormData 对象
        for (var i = 0; i < document.getElementById("file").files.length; i++) {
            var fileObj = document.getElementById("file").files[i];
            form.append("mf" + i, fileObj); // 文件对象
        }
        form.append("userid", user_id);
        form.append("token", token);
        form.append("content", content);
        form.append("weather", weather);
        form.append("add_time", add_time);
        form.append("roleType", roleType);
        xhr = new XMLHttpRequest(); // XMLHttpRequest 对象
        xhr.open("post", url, true); //post方式，url为服务器请求地址，true 
        xhr.onload = uploadComplete; //请求完成
        xhr.onerror = uploadFailed; //请求失败
        xhr.send(form);


        //上传成功响应
        function uploadComplete(evt) {
            //服务断接收完文件返回的结果
            //    alert(evt.target.responseText);
            alert("上传成功！");
            location.reload()
            // window.location.replace(etzrUrl + "/");
        }
        //上传失败
        function uploadFailed(evt) {
            alert("上传失败！");
        }
    }
    </script>
</body>

</html>